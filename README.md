# CSV Employee Reader

Это небольшой Java-проект для чтения и обработки CSV-файла с данными о сотрудниках. Проект парсит данные из файла `people.csv`, создаёт объекты моделей `Person` и `Department`, выполняет валидацию данных с использованием Jakarta Validation, и выводит статистику: общее количество сотрудников, среднюю зарплату, распределение по полам, статистику по подразделениям, а также дополнительную аналитику (самый старший/младший сотрудник, самая высокая/низкая зарплата).

Проект использует Maven для сборки, OpenCSV для парсинга CSV, Hibernate Validator для валидации, и Lombok для упрощения кода моделей.

## Функциональность

- **Чтение CSV**: Поддержка формата с разделителем `;`. Ожидаемые столбцы: `id`, `name`, `gender`, `BirtDate`, `Division`, `Salary`.
- **Парсинг и валидация**: 
  - ID генерируется автоматически, если не указан.
  - Пол парсится с поддержкой вариаций (MALE/FEMALE, M/F, МУЖ/ЖЕН и т.д.), по умолчанию MALE.
  - Дата рождения поддерживает форматы `dd.MM.yyyy`, `dd-MM-yyyy`, `dd/MM/yyyy`.
  - Зарплата парсится как BigDecimal, с обработкой ошибок (по умолчанию 0).
  - Валидация: имя не пустое, зарплата > 0, дата в прошлом и т.д.
- **Кэширование подразделений**: Подразделения хранятся в Map для быстрого доступа.
- **Вывод статистики**: В консоль выводится общая статистика, данные по подразделениям, примеры записей и аналитика.
- **Обработка ошибок**: Логирование ошибок парсинга, пропуск некорректных строк.

## Требования

- Java 21 или выше.
- Maven 3.x для сборки.
- Файл `people.csv` должен находиться в `src/main/resources/` (пример данных предоставлен в проекте).

## Установка

1. Клонируйте репозиторий:
   ```
   git clone <your-repo-url>
   cd csv-reader
   ```

2. Соберите проект с помощью Maven:
   ```
   mvn clean install
   ```

## Использование

1. Убедитесь, что файл `people.csv` находится в `src/main/resources/`. Если нужно, замените его на свой CSV-файл с аналогичной структурой.

2. Запустите приложение:
   ```
   mvn exec:java -Dexec.mainClass="Main"
   ```

   Или в IDE (например, IntelliJ IDEA): Запустите класс `Main.java`.

3. Вывод в консоль:
   - Диагностика обработки CSV.
   - Итоговая статистика (количество сотрудников, средняя зарплата, распределение по полам).
   - Статистика по подразделениям.
   - Примеры первых 5 записей.
   - Аналитика (самый старший/младший, самая высокая/низкая зарплата).

Пример вывода (фрагмент):
```
=== CSV READER - ОБРАБОТКА ФАЙЛА С СОТРУДНИКАМИ ===
=== НАЧАЛО ОБРАБОТКИ CSV ===
Заголовок файла: [id, name, gender, BirtDate, Division, Salary]
Ожидаемый формат: [id, name, gender, BirtDate, Division, Salary]

Строка 1 (индекс в файле: 2):
  Raw data: [28281, Aahan, Male, 15.05.1970, I, 4800]
  Field count: 6
✓ Успешно обработан: Aahan (ID: 28281, Отдел: Отдел I, Дата: 15.05.1970, ЗП: 4800)
...

ИТОГОВАЯ СТАТИСТИКА
Всего сотрудников загружено: 25898
Средняя зарплата: 5000.00
Мужчин: 12949 (50.0%)
Женщин: 12949 (50.0%)
Количество подразделений: 15
```

## Структура проекта

- **models/**: Модели данных.
  - `Department.java`: Модель подразделения с авто-генерацией ID.
  - `Person.java`: Модель сотрудника с валидацией полей и парсингом даты.
  - `enums/Gender.java`: Перечисление для пола (MALE, FEMALE).
- **service/**: Сервис для чтения CSV.
  - `CSVReaderService.java`: Интерфейс.
  - `impl/CSVReaderServiceImpl.java`: Реализация с парсингом, валидацией и кэшированием.
- `Main.java`: Точка входа, запускает чтение и выводит статистику.
- `people.csv`: Пример CSV-файла с данными ~25k записей.
- `pom.xml`: Maven-конфигурация с зависимостями (OpenCSV, Hibernate Validator, Lombok, JUnit).
- **tests/**: Юнит-тесты.
  - `CSVReaderServiceImplTest.java`: Тесты на успешное чтение, кэш подразделений и обработку ошибок (файл не найден).

## Тесты

Запустите тесты с Maven:
```
mvn test
```

Тесты проверяют:
- Успешный парсинг файла `people.csv` (количество записей, данные первых/последних).
- Кэш подразделений (количество, наличие ключей A-O).
- Обработку ошибки "файл не найден" (кидает IOException с причиной FileNotFoundException).

## Возможные улучшения

- Добавить поддержку других форматов даты/пола.
- Расширить аналитику (например, фильтры по дате, экспорт в JSON).
- Обработать большие файлы (потоковая обработка).

## Лицензия

Этот проект распространяется под лицензией MIT (или укажите свою).
